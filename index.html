<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Извлечение чисел и проверка дубликатов</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        textarea {
            width: 100%;
            height: 150px;
            margin-bottom: 20px;
            resize: none;
            white-space: nowrap;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 10px;
        }
        label {
            font-size: 18px;
            font-weight: bold;
        }
        #copyBtn {
            background-color: #008CBA;
        }
        #copyBtn:hover {
            background-color: #007bb5;
        }
        .highlight-duplicate {
            color: red;
            font-weight: bold;
        }
        .numbered-links {
            counter-reset: link-counter;
        }
        .numbered-links div {
            counter-increment: link-counter;
        }
        .numbered-links div::before {
            content: counter(link-counter) ". ";
            font-weight: bold;
            margin-right: 10px;
        }
        .clear-btn {
            cursor: pointer;
            color: red;
            margin-left: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="container">
    <label for="linksInput">Вставьте ссылки (каждая с новой строки):</label>

    <span class="clear-btn" onclick="clearFields()">Нажми сюда, чтобы очистить поле ✖</span>
    <br>
    <br>

    <textarea id="linksInput" oninput="updateLinks()"></textarea>

    <label for="linksOutput">Результат (дубликаты ссылок подсвечены красным):</label>
    <div class="numbered-links" id="linksOutput" style="border: 1px solid #ccc; padding: 10px; min-height: 150px; white-space: pre-wrap; font-size: 12px;"></div>
</div>

<div class="container">
    <button onclick="extractNumbers()">Извлечь числа</button>
    <button id="copyBtn" onclick="copyToClipboard()">Скопировать результат</button>
    <br>
    <br>
    <label for="numbersOutput">Результат (дубликаты чисел подсвечены красным):</label>
    <div id="numbersOutput" style="white-space: pre-wrap; border: 1px solid #ccc; padding: 10px; min-height: 150px; font-size: 12px;"></div>
</div>

<script>
    // Обновляем список ссылок с нумерацией и проверкой на дубликаты
    function updateLinks() {
        const input = document.getElementById('linksInput').value;
        const links = input.split('\n').map(link => link.trim()).filter(link => link.length > 0);

        const uniqueLinks = new Set();
        const duplicates = new Set();

        // Проверяем на дубликаты
        links.forEach(link => {
            if (uniqueLinks.has(link)) {
                duplicates.add(link);
            } else {
                uniqueLinks.add(link);
            }
        });

        // Формируем вывод с нумерацией и подсветкой дубликатов
        const linksOutput = document.getElementById('linksOutput');
        linksOutput.innerHTML = links.map(link =>
            duplicates.has(link) ? `<div class="highlight-duplicate">${link}</div>` : `<div>${link}</div>`
        ).join('');
    }

    // Извлекаем числа из ссылок и подсвечиваем дубликаты
    function extractNumbers() {
        const links = document.getElementById('linksInput').value.split('\n').map(link => link.trim()).filter(link => link.length > 0);

        let numbers = [];
        let duplicates = new Set();
        let uniqueNumbers = new Set();

        // Извлекаем последние числа после символа "_"
        links.forEach(link => {
            const lastUnderscoreIndex = link.lastIndexOf('_');
            if (lastUnderscoreIndex !== -1) {
                const number = link.substring(lastUnderscoreIndex + 1).trim();
                if (uniqueNumbers.has(number)) {
                    duplicates.add(number);
                } else {
                    uniqueNumbers.add(number);
                }
                numbers.push(number);
            }
        });

        // Выводим результат с подсветкой дубликатов
        const numbersOutput = document.getElementById('numbersOutput');
        numbersOutput.innerHTML = numbers.map(number =>
            duplicates.has(number) ? `<span class="highlight-duplicate">${number}</span>` : number
        ).join('<br>');
    }

    // Копируем результат в буфер обмена
    function copyToClipboard() {
        const output = document.getElementById('numbersOutput').innerText;

        navigator.clipboard.writeText(output).then(() => {
            alert("Результат скопирован!");
        }).catch(err => {
            alert("Ошибка при копировании: " + err);
        });
    }

    // Очищаем поля ввода и вывода
    function clearFields() {
        document.getElementById('linksInput').value = '';
        document.getElementById('linksOutput').innerHTML = '';
        document.getElementById('numbersOutput').innerHTML = '';
    }
</script>

</body>
</html>
